# Kubernetes Namespace and Shared Resources
#
# Apply using deploy.sh (recommended):
#   ./deploy/k8s/deploy.sh http   # or slim
#
# Or manually:
#   export NAMESPACE=lumuscar-jobs
#   export TRANSPORT_MODE=http
#   envsubst < deploy/k8s/namespace.yaml | kubectl apply -f -
#
# Then create the secret:
#   kubectl create secret generic azure-openai-credentials \
#     --from-literal=api-key=$AZURE_OPENAI_API_KEY \
#     --from-literal=endpoint=$AZURE_OPENAI_ENDPOINT \
#     --from-literal=deployment-name=${AZURE_OPENAI_DEPLOYMENT_NAME:-gpt-4o} \
#     -n $NAMESPACE
#
# Environment Variables:
#   NAMESPACE          - Target namespace (default: lumuscar-jobs)
#   TRANSPORT_MODE     - Transport mode: "slim" or "http" (default: http)
#   SLIM_GATEWAY_HOST  - SLIM gateway host (default: slim-slim-node)
#   SLIM_GATEWAY_PORT  - SLIM gateway port (default: 46357)

---
apiVersion: v1
kind: Namespace
metadata:
  name: ${NAMESPACE}
  labels:
    app.kubernetes.io/part-of: tourist-scheduling

---
# ConfigMap for shared configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: agent-config
  namespace: ${NAMESPACE}
  labels:
    app.kubernetes.io/part-of: tourist-scheduling
data:
  # Azure OpenAI configuration
  AZURE_OPENAI_API_VERSION: "2024-02-01"

  # Agent ports
  UI_A2A_PORT: "10021"
  SCHEDULER_PORT: "10000"

  # Transport configuration
  # Options: "slim" for SLIM transport, "http" for direct HTTP
  TRANSPORT_MODE: "${TRANSPORT_MODE}"

  # SLIM configuration (used when TRANSPORT_MODE=slim)
  SLIM_GATEWAY_HOST: "${SLIM_GATEWAY_HOST}"
  SLIM_GATEWAY_PORT: "${SLIM_GATEWAY_PORT}"

  # Service URLs (computed based on transport mode)
  # For HTTP mode: http://scheduler-agent:10000
  # For SLIM mode: configured via SLIM_GATEWAY
  SCHEDULER_URL: "${SCHEDULER_URL}"
  UI_DASHBOARD_URL: "${UI_DASHBOARD_URL}"

